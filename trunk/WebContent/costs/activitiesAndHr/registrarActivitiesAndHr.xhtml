<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	template="/plantillas/plantilla.xhtml">
	<ui:param name="action"
		value="activitiesAndHrAction.inicializarActivitiesAndHr()" />
	<ui:param name="titulo"
		value="mensajeMenu.recursos_humanos_activities_label" />
	<ui:define name="body">
		<script type="text/javascript"
			src="#{request.contextPath}/js/jquery.js"></script>
		<script type="text/javascript"
			src="#{request.contextPath}/js/jquery.maxlength-min.js"></script>
		<script type="text/javascript">
			$g = jQuery.noConflict();
			$g(document).ready(function() {
				$g('#formActivitiesAndHr\\:descripcion').maxlength({
					events : [],
					max : 250,
					feedbackText : "#{mensaje.label_caracteres_restantes}",
					showFeedback : 'active'
				});
			});
		</script>
		<t:saveState value="#{activitiesAndHrAction}" />
		<t:saveState value="#{controllerSortField}" />
		<!-- Parameters for the order list -->
		<ui:param name="renderList" value="paginas" />
		<ui:param name="actionList" value="#{activitiesAndHrAction}" />
		<ui:param name="methodList" value="consultarActivities" />
		<h:form id="formActivitiesAndHr">
			<rich:panel
				header="#{mensaje.label_registrar} #{mensajeMenu.recursos_humanos_activities_label}"
				styleClass="anchoUno MinH253P" id="panelRegistrarActivitiesAndHr">
				<t:fieldset styleClass="anchoDos BorderW2P">
					<legend class="etiquetaTitulo">#{mensajeLifeCycle.crops_label}</legend>
					<h:panelGrid columns="4"
						cellpadding="#{propPrototipoCostos['locate.fields.cellpadding']}"
						cellspacing="#{propPrototipoCostos['locate.fields.cellspacing']}"
						columnClasses="tdAlignTop,tdAlignTop">
						<h:outputText value="#{mensajeLifeCycle.crop_names_label}"
							styleClass="etiquetaTitulo" />
						<h:outputText value="" styleClass="required" />
						<h:selectOneMenu id="cropName"
							value="#{activitiesAndHrAction.idCrop}"
							styleClass="colTextoMediano" required="true"
							disabled="#{activitiesAndHrAction.actividades.size() gt 0}">
							<f:selectItem itemLabel="#{mensaje.label_seleccionar}"
								itemValue="0" />
							<f:selectItems value="#{activitiesAndHrAction.listaCropNames}" />
							<f:ajax event="change"
								listener="#{activitiesAndHrAction.mostrarCrops()}"
								render=":formActivitiesAndHr" />
						</h:selectOneMenu>
						<rich:message for="cropName" />

						<h:outputText value="#{mensajeLifeCycle.crops_label}"
							styleClass="etiquetaTitulo" />
						<h:outputText value="" styleClass="required" />
						<h:selectOneMenu id="crop"
							value="#{activitiesAndHrAction.nombreCrop}"
							styleClass="colTextoMediano" required="true"
							disabled="#{activitiesAndHrAction.actividades.size() gt 0}">
							<f:selectItem itemLabel="#{mensaje.label_seleccionar}"
								itemValue="0" />
							<f:selectItems value="#{activitiesAndHrAction.listaCrops}" />
							<f:ajax event="change"
								listener="#{activitiesAndHrAction.mostrarActivities()}"
								render=":formActivitiesAndHr" />
						</h:selectOneMenu>
						<rich:message for="crop" />
					</h:panelGrid>
				</t:fieldset>
				<br />
				<t:fieldset styleClass="anchoDos BorderW2P"
					rendered="#{activitiesAndHrAction.nombreCrop gt 0 }">
					<legend class="etiquetaTitulo">#{mensajeCosts.activities_label_s}</legend>
					<h:panelGrid columns="3"
						cellpadding="#{propPrototipoCostos['locate.fields.cellpadding']}"
						cellspacing="#{propPrototipoCostos['locate.fields.cellspacing']}"
						columnClasses="tdAlignTop,"
						rendered="#{activitiesAndHrAction.actividades eq null or (empty activitiesAndHrAction.actividades)}">
						<h:outputText value="#{mensajeLifeCycle.activity_names_label}"
							styleClass="etiquetaTitulo" />
						<h:selectOneMenu id="activities"
							value="#{activitiesAndHrAction.activities.idActivity}"
							styleClass="colTextoCorto" required="true"
							disabled="#{activitiesAndHrAction.nombreCrop eq 0 or activitiesAndHrAction.idCrop eq 0}">
							<f:selectItem itemLabel="#{mensaje.label_todos}" itemValue="0" />
							<f:selectItems value="#{activitiesAndHrAction.listaActivities}" />
						</h:selectOneMenu>
						<rich:message for="activities" />
						<h:outputText value="#{mensaje.label_fecha_inicio}"
							styleClass="etiquetaTitulo" />
						<p:calendar
							value="#{activitiesAndHrAction.activities.initialDtBudget}"
							pattern="MM/dd/yyyy HH:mm"
							disabled="#{activitiesAndHrAction.nombreCrop eq 0 or activitiesAndHrAction.idCrop eq 0}"
							styleClass="W104P" id="fechaInicio" showOn="button"
							maxdate="#{activitiesAndHrAction.activities.finalDtBudget}"
							navigator="true"
							converterMessage="#{mensaje.message_validar_formato_fecha}">
							<p:ajax event="dateSelect" update="fechaFinal" />
						</p:calendar>
						<rich:message for="fechaInicio" />
						<h:outputText value="#{mensaje.label_fecha_fin}"
							styleClass="etiquetaTitulo" />
						<p:calendar
							value="#{activitiesAndHrAction.activities.finalDtBudget}"
							pattern="MM/dd/yyyy HH:mm" styleClass="W104P" id="fechaFinal"
							showOn="button"
							mindate="#{activitiesAndHrAction.activities.initialDtBudget}"
							disabled="#{activitiesAndHrAction.nombreCrop eq 0 or activitiesAndHrAction.idCrop eq 0}"
							navigator="true"
							converterMessage="#{mensaje.message_validar_formato_fecha}">
							<p:ajax event="dateSelect" update="fechaInicio" />
						</p:calendar>
						<rich:message for="fechaFinal" />
						<h:outputText value="#{mensaje.label_descripcion}"
							styleClass="etiquetaTitulo" />
						<h:inputTextarea
							disabled="#{activitiesAndHrAction.nombreCrop eq 0 or activitiesAndHrAction.idCrop eq 0}"
							value="#{activitiesAndHrAction.activities.description}"
							styleClass="colTextoMedianoTextArea" id="descripcion"
							validator="#{encodeFilter.validarScripting}">
							<f:validateLength maximum="250" />
						</h:inputTextarea>
						<rich:message for="activities" />
					</h:panelGrid>
					<div align="center">
						<a:commandButton id="lnkActivityStandard"
							rendered="#{activitiesAndHrAction.actividades eq null or (empty activitiesAndHrAction.actividades)}"
							disabled="#{activitiesAndHrAction.nombreCrop eq 0 or activitiesAndHrAction.idCrop eq 0}"
							render="formActivitiesAndHr, mensajes, mensajeBusqueda"
							actionListener="#{activitiesAndHrAction.consultarActivities()}"
							execute="formActivitiesAndHr"
							value="#{mensaje.label_show} #{mensajeCosts.activities_label_s}">
						</a:commandButton>
					</div>
					<a:outputPanel id="paginas">
						<rich:dataTable value="#{activitiesAndHrAction.actividades}"
							var="actividad" id="seleccionadas" footerClass="H130P"
							styleClass="#{listaVacia ? 'BCTransparente' : 'dataTable'} anchoDos"
							rowClasses="#{actividad.seleccionado ? 'rf-ddm-itm-sel backgroundNone left':'odd-row'} , #{actividad.seleccionado ? 'rf-ddm-itm-sel backgroundNone left' : 'even-row'}"
							rendered="#{activitiesAndHrAction.actividades.size() gt 0}">
							<rich:column styleClass="colIconoUno verticalAlignMiddle">
								<f:facet name="header" />
								<a:commandLink>
									<h:panelGrid styleClass="tablaIconoTexto" columns="2">
										<h:graphicImage value="/img/seleccionarRadioCheck_16.png"
											styleClass="verticalAlignMiddle"
											rendered="#{actividad.seleccionado eq true}" />
										<h:graphicImage value="/img/seleccionarRadioOut_16.png"
											styleClass="verticalAlignMiddle"
											rendered="#{actividad.seleccionado eq false}" />
									</h:panelGrid>
									<f:ajax event="click"
										listener="#{activitiesAndHrAction.asignarActividad(actividad)}"
										render="@form" />
								</a:commandLink>
							</rich:column>
							<rich:column styleClass="colTextoCorto verticalAlignMiddle">
								<f:facet name="header">
									<ui:include src="/plantillas/templateHeaderSort.xhtml">
										<ui:param name="title" value="#{mensaje.label_nombre}" />
										<ui:param name="sortField" value="an.activityName" />
									</ui:include>
								</f:facet>
								<h:outputText value="#{actividad.activityName.activityName}" />
							</rich:column>
							<rich:column styleClass="colTextoMediano verticalAlignMiddle">
								<f:facet name="header">#{mensaje.label_descripcion}</f:facet>
								<h:outputText
									value="#{actividad.description.length() gt propPrototipoCostos['locate.activitiesandhr.long.descripcion'] ? actividad.description.substring(0, propPrototipoCostos['locate.activitiesandhr.long.descripcion']) : actividad.description} #{actividad.description.length() gt propPrototipoCostos['locate.activitiesandhr.long.descripcion'] ? '...' : ''}" />
								<rich:tooltip layout="block" styleClass="campoTooltip"
									rendered="#{actividad.description ne null}">
									<h:outputText value="#{actividad.description}" />
								</rich:tooltip>
							</rich:column>
							<rich:column styleClass="colNumeroMini verticalAlignMiddle">
								<f:facet name="header">#{mensajeCosts.cycle_standard_activities_label_secuencia_abr}</f:facet>
								<h:outputText value="#{actividad.sequenceNumber}" />
							</rich:column>
							<rich:column styleClass="colFechaExtraLarga verticalAlignMiddle">
								<f:facet name="header">
									<ui:include src="/plantillas/templateHeaderSort.xhtml">
										<ui:param name="title"
											value="#{mensajeCosts.budget_label_hora_inicio}" />
										<ui:param name="sortField" value="a.initialDtBudget" />
									</ui:include>
								</f:facet>
								<h:outputText value="#{actividad.initialDtBudget}">
									<f:convertDateTime type="date" pattern="dd/MM/YYYY HH:mm:ss"
										locale="#{idioma.locale}" />
								</h:outputText>
							</rich:column>
							<rich:column styleClass="colFechaExtraLarga verticalAlignMiddle">
								<f:facet name="header">
									<ui:include src="/plantillas/templateHeaderSort.xhtml">
										<ui:param name="title"
											value="#{mensajeCosts.budget_label_hora_fin}" />
										<ui:param name="sortField" value="a.finalDtBudget" />
									</ui:include>
								</f:facet>
								<h:outputText value="#{actividad.finalDtBudget}">
									<f:convertDateTime type="date" pattern="dd/MM/YYYY HH:mm:ss"
										locale="#{idioma.locale}" />
								</h:outputText>
							</rich:column>
							<rich:column styleClass="colNumero verticalAlignMiddle">
								<f:facet name="header">#{mensajeCosts.budget_label_duracion}</f:facet>
								<h:outputText value="#{actividad.durationBudget}" />
							</rich:column>
							<rich:column styleClass="center colIconoDos verticalAlignMiddle">
								<f:facet name="header">#{mensajeCosts.cycle_standard_activities_label_peligroso}</f:facet>
								<h:graphicImage value="/img/peligroso_19.png"
									rendered="#{actividad.dangerous eq true}" />
								<rich:tooltip layout="block"
									rendered="#{actividad.dangerous eq true}">
									<h:outputText value="#{mensaje.label_dangerous}" />
								</rich:tooltip>
							</rich:column>
							<f:facet name="footer">
								<rich:columnGroup rendered="#{listaVacia}">
									<rich:column colspan="5" styleClass="footTabla">
										<h:outputText
											value="#{mensaje.message_no_existen_registros_tabla}" />
									</rich:column>
								</rich:columnGroup>
							</f:facet>
						</rich:dataTable>
						<br />
						<a:outputPanel
							rendered="#{activitiesAndHrAction.actividades.size() gt 0}">
							<div class="anchoDos center inBlock">
								<ui:include src="/plantillas/plantillaPaginador.xhtml">
									<ui:param name="conParam2" value="1" />
									<ui:param name="pager" value="paginador" />
									<ui:param name="valReder" value="paginas" />
									<ui:param name="beanActionParam"
										value="#{activitiesAndHrAction}" />
									<ui:param name="metodoActionParam" value="consultarActivities" />
								</ui:include>
							</div>
						</a:outputPanel>
					</a:outputPanel>
				</t:fieldset>
				<br />
				<h:panelGrid columns="1"
					cellpadding="#{propPrototipoCostos['locate.fields.cellpadding']}"
					cellspacing="#{propPrototipoCostos['locate.fields.cellspacing']}"
					columnClasses="tdAlignTop"
					rendered="#{activitiesAndHrAction.actividadSeleccionada.idActivity gt 0}">
					<t:fieldset styleClass="anchoDos BorderW2P">
						<legend class="etiquetaTitulo" id="tooltip">
							#{activitiesAndHrAction.actividadSeleccionada.activityName.activityName}
							<rich:tooltip layout="block" target="tooltip">
								<h:panelGrid columns="1">
									<h:outputText
										value="#{activitiesAndHrAction.actividadSeleccionada.description}" />
									<h:outputText
										value="#{activitiesAndHrAction.actividadSeleccionada.initialDtBudget}" />
								</h:panelGrid>
							</rich:tooltip>
						</legend>
						<div class="anchoDos">
							<a:commandLink styleClass="iconsDataTable"
								rendered="#{activitiesAndHrAction.actividadSeleccionada.seleccionado ne false}"
								render="seleccionarTrabajador:popupTrabajador seleccionarTrabajador:trabajadores mensajes mensajeBusqueda"
								actionListener="#{activitiesAndHrAction.mostrarTipoTrabajador()}"
								execute="formActivitiesAndHr"
								oncomplete="if (#{facesContext.maximumSeverity==null})
								{#{rich:component('popupTrabajador')}.show();} else{ 
								setFocus(#{rich:element('formGenerico:valFocus')}.value); }">
								<h:panelGrid styleClass="tablaIconoTexto" columns="2">
									<h:graphicImage value="/img/add_16.png"
										styleClass="verticalAlignMiddle" />
									<h:outputText
										value="#{mensaje.label_asignar} #{mensajeCosts.activities_and_hr_label_trabajadores}" />
								</h:panelGrid>
								<rich:tooltip layout="block">
									<h:outputText value="#{mensaje.label_seleccionar}" />
								</rich:tooltip>
							</a:commandLink>
						</div>
						<ui:param name="listaVaciaA"
							value="#{activitiesAndHrAction.listaActivitiesAndHrTemp.size() eq null}" />
						<rich:dataTable
							value="#{activitiesAndHrAction.listaActivitiesAndHrTemp}"
							var="actividadesTrabajadores" id="listaEmpleados"
							footerClass="H130P"
							styleClass="#{listaVaciaA ? 'BCTransparente' : 'dataTable'} anchoDos"
							rowClasses="odd-row, even-row">
							<rich:column styleClass=""
								rendered="#{(identity.autorizado('activitiesAndHrAction','A') or identity.autorizado('activitiesAndHrAction','D'))}">
								<a:outputPanel>
									<a:commandLink render="popupEliminar"
										rendered="#{actividadesTrabajadores.initialDateTimeActual eq null}"
										actionListener="#{activitiesAndHrAction.setActivitiesAndHr(actividadesTrabajadores)}"
										oncomplete="#{rich:component('popupEliminar')}.show()">
										<h:graphicImage value="/img/delete_16.png" />
										<rich:tooltip layout="block">
											<h:outputText value="#{mensaje.button_eliminar}" />
										</rich:tooltip>
									</a:commandLink>
									<h:graphicImage value="/img/delete_no_available_16.png"
										rendered="#{actividadesTrabajadores.initialDateTimeActual ne null}" />
								</a:outputPanel>
							</rich:column>
							<rich:column styleClass="colTextoMediano">
								<f:facet name="header">#{mensaje.label_nombre}</f:facet>
								<a:commandLink
									rendered="#{actividadesTrabajadores.initialDateTimeActual eq null}"
									action="#{activitiesAndHrAction.setActivitiesAndHr(actividadesTrabajadores.clone())}"
									oncomplete="if (#{facesContext.maximumSeverity==null}) {#{rich:component('popUpEditarActivitiesAndHr')}.show();} else { setFocus(#{rich:element('formGenerico:valFocus')}.value); }"
									value="#{actividadesTrabajadores.activitiesAndHrPK.hr.name} #{actividadesTrabajadores.activitiesAndHrPK.hr.familyName}"
									render="popUpEditarActivitiesAndHr">
									<f:setPropertyActionListener
										target="#{activitiesAndHrAction.idOvertimeRate}"
										value="#{actividadesTrabajadores.overtimePaymentRate.overtimepaymentid}" />
								</a:commandLink>
								<h:outputText
									rendered="#{actividadesTrabajadores.initialDateTimeActual ne null}"
									value="#{actividadesTrabajadores.activitiesAndHrPK.hr.name} #{actividadesTrabajadores.activitiesAndHrPK.hr.familyName}" />
							</rich:column>
							<rich:column styleClass="colFechaExtraLarga">
								<f:facet name="header">#{mensajeCosts.budget_label_hora_inicio}</f:facet>
								<h:outputText
									value="#{actividadesTrabajadores.initialDateTimeBudget}">
									<f:convertDateTime type="date" pattern="dd/MM/YYYY HH:mm:ss"
										locale="#{idioma.locale}" />
								</h:outputText>
							</rich:column>
							<rich:column styleClass="colFechaExtraLarga">
								<f:facet name="header">#{mensajeCosts.budget_label_hora_fin}</f:facet>
								<h:outputText
									value="#{actividadesTrabajadores.finalDateTimeBudget}">
									<f:convertDateTime type="date" pattern="dd/MM/YYYY HH:mm:ss"
										locale="#{idioma.locale}" />
								</h:outputText>
							</rich:column>
							<rich:column styleClass="colNumero">
								<f:facet name="header">#{mensajeCosts.budget_label_duracion}</f:facet>
								<h:outputText value="#{actividadesTrabajadores.durationBudget}" />
							</rich:column>
							<rich:column styleClass="colValor">
								<f:facet name="header">#{mensajeCosts.budget_label_cost}</f:facet>
								<h:outputText value="#{actividadesTrabajadores.totalCostBudget}" />
							</rich:column>
							<rich:column styleClass="colNumero">
								<f:facet name="header">#{mensajeCosts.activities_and_hr_label_hora_normal}</f:facet>
								<h:outputText value="#{actividadesTrabajadores.normalHours}" />
							</rich:column>
							<rich:column styleClass="colNumero">
								<f:facet name="header">#{mensajeCosts.activities_and_hr_label_horas_extra}</f:facet>
								<h:outputText value="#{actividadesTrabajadores.overtimeHours}" />
							</rich:column>
							<rich:column styleClass="colNumero">
								<f:facet name="header">#{mensajeCosts.activities_and_hr_label_horas_totales}</f:facet>
								<h:outputText value="#{actividadesTrabajadores.totalHours}" />
							</rich:column>
							<f:facet name="footer">
								<rich:columnGroup rendered="#{listaVaciaA}">
									<rich:column colspan="9" styleClass="footTabla">
										<h:outputText
											value="#{mensaje.message_no_existen_registros_tabla}" />
									</rich:column>
								</rich:columnGroup>
							</f:facet>
						</rich:dataTable>
						<br />
						<a:outputPanel id="paginadoEmpleados"
							rendered="#{activitiesAndHrAction.listaActivitiesAndHrTemp.size() gt 0}">
							<div class="anchoDos center inBlock">
								<ui:include src="/plantillas/plantillaPaginador.xhtml">
									<ui:param name="conParam2" value="1" />
									<ui:param name="valId" value="2" />
									<ui:param name="pager" value="paginadorActivitiesAndHr" />
									<ui:param name="valReder"
										value="listaEmpleados paginadoEmpleados" />
									<ui:param name="beanActionParam"
										value="#{activitiesAndHrAction}" />
									<ui:param name="metodoActionParam"
										value="consultarActivitiesAndHrXActividad" />
								</ui:include>
							</div>
						</a:outputPanel>
					</t:fieldset>
				</h:panelGrid>
				<br />
				<div align="center">
					<a:commandButton id="back" execute="@form"
						render="formActivitiesAndHr, mensajes"
						rendered="#{activitiesAndHrAction.actividades.size() gt 0}"
						actionListener="#{activitiesAndHrAction.inicializarActivitiesAndHr()}"
						value="#{mensaje.button_back}">
					</a:commandButton>
				</div>
			</rich:panel>
		</h:form>
		<ui:include src="plantillaPopUpActivitiesAndHr.xhtml">
		</ui:include>
	</ui:define>
</ui:composition>