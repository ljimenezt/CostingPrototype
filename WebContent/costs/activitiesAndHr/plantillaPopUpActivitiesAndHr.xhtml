<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:a="http://richfaces.org/a4j" xmlns:p="http://primefaces.org/ui"
	xmlns:t="http://myfaces.apache.org/tomahawk">
	<h:form id="seleccionarTrabajador">
		<rich:popupPanel id="popupTrabajador" autosized="true" maxWidth="430"
			domElementAttachment="form"
			header="#{mensajeCosts.activities_and_hr_label_trabajadores} #{mensaje.label_para} #{activitiesAndHrAction.actividadSeleccionada.activityName.activityName}">
			<f:facet name="controls">
				<h:panelGroup>
					<h:graphicImage value="/img/close_14.png"
						onmouseover="this.src='#{request.contextPath}/img/closeHover_14.png';"
						onmouseout="this.src='#{request.contextPath}/img/close_14.png';"
						styleClass="cursor"
						onclick="#{rich:component('popupTrabajador')}.hide()" />
				</h:panelGroup>
			</f:facet>
			<rich:panel styleClass="H383P fondoAnchoUno W400P">
				<a:outputPanel id="outPutBuscarTrabajador">
					<a:outputPanel id="outputTrabajador">
						<t:fieldset styleClass="BorderW2P">
							<legend class="etiquetaTitulo">#{mensajeRecursosHumanos.tipo_recurso_humano_label}</legend>
							<h:panelGrid columns="2"
								columnClasses="tdAlignTop center, center">
								<h:outputText
									value="#{mensajeRecursosHumanos.tipo_recurso_humano_label}"
									styleClass="etiquetaTitulo" />
								<h:selectOneMenu id="trabajador"
									value="#{activitiesAndHrAction.idTrabajador}"
									styleClass="W180P" required="true">
									<f:selectItem itemLabel="#{mensaje.label_todos}" itemValue="0" />
									<f:selectItems
										value="#{activitiesAndHrAction.listaTipoTrabajador}" />
									<f:ajax event="change"
										listener="#{activitiesAndHrAction.inicializarTrabajadores()}"
										render="outputBuscar" />
								</h:selectOneMenu>
							</h:panelGrid>
						</t:fieldset>
						<br />
						<t:fieldset styleClass="BorderW2P">
							<legend class="etiquetaTitulo">#{mensajeRecursosHumanos.recurso_humano_label_s}</legend>
							<a:outputPanel id="outputBuscar">
								<ui:param name="listaVacia"
									value="#{activitiesAndHrAction.trabajadores eq null or (empty activitiesAndHrAction.trabajadores)}" />
								<rich:dataTable value="#{activitiesAndHrAction.trabajadores}"
									var="trabajador" id="trabajadores" footerClass="H130P"
									styleClass="#{listaVacia ? 'BCTransparente' : 'dataTable'} W350P"
									rowClasses="odd-row, even-row">

									<rich:column styleClass="colIconoUno">
										<f:facet name="header" />
										<a:commandLink
											actionListener="#{activitiesAndHrAction.seleccionarTrabajador(trabajador)}"
											render="popUpAgregarTrabajador, trabajadores"
											oncomplete="if(#{activitiesAndHrAction.validacionTrabajador==false}){#{rich:component('popUpAgregarTrabajador')}.show();}">
											<h:panelGrid styleClass="tablaIconoTexto" columns="2">
												<h:graphicImage value="/img/okPermiso_16.png"
													styleClass="verticalAlignMiddle"
													rendered="#{trabajador.seleccionado eq true}" />
												<h:graphicImage value="/img/seleccionarRadioOut_16.png"
													styleClass="verticalAlignMiddle"
													rendered="#{trabajador.seleccionado eq false or (trabajador.seleccionado eq null)}" />
											</h:panelGrid>
										</a:commandLink>
									</rich:column>

									<rich:column width="300px">
										<f:facet name="header">#{mensaje.label_nombre}</f:facet>
										<h:outputText
											value="#{trabajador.name} #{trabajador.familyName}" />
									</rich:column>

									<f:facet name="footer">
										<rich:columnGroup rendered="#{listaVacia}">
											<rich:column colspan="5" styleClass="footTabla">
												<h:outputText
													rendered="#{activitiesAndHrAction.messageWorkersAvailability eq propPrototipoCostos['locate.activitiesandhr.hr.certified'] and activitiesAndHrAction.trabajadores eq null}"
													value="#{mensaje.message_personal_certifies_no_disponible}" />
												<h:outputText
													rendered="#{activitiesAndHrAction.messageWorkersAvailability eq propPrototipoCostos['locate.activitiesandhr.certified'] and activitiesAndHrAction.trabajadores eq null}"
													value="#{mensaje.message_personal_certified}" />
												<h:outputText
													rendered="#{activitiesAndHrAction.messageWorkersAvailability eq null}"
													value="#{mensaje.message_personal_not_exists}" />
												<h:outputText
													rendered="#{activitiesAndHrAction.messageWorkersAvailability eq propPrototipoCostos['locate.activitiesandhr.hr.certified.maternity'] and activitiesAndHrAction.trabajadores eq null}"
													value="#{mensaje.message_personal_certified_maternity}" />
											</rich:column>
										</rich:columnGroup>
									</f:facet>
								</rich:dataTable>
								<br />
								<a:outputPanel rendered="#{!listaVacia}">
									<div class="W350P center inBlock">
										<ui:include src="/plantillas/plantillaPaginador.xhtml">
											<ui:param name="valParam2" value="si" />
											<ui:param name="conParam2" value="1" />
											<ui:param name="pager" value="paginadorTrabajador" />
											<ui:param name="valReder"
												value=":seleccionarTrabajador:outputBuscar" />
											<ui:param name="beanActionParam"
												value="#{activitiesAndHrAction}" />
											<ui:param name="metodoActionParam"
												value="consultarTrabajador" />
										</ui:include>
									</div>
								</a:outputPanel>
							</a:outputPanel>
						</t:fieldset>
					</a:outputPanel>
					<br />
					<div align="center">
						<a:commandButton value="#{mensaje.button_agregar}"
							render=":formActivitiesAndHr, mensajes, mensajeBusqueda"
							actionListener="#{activitiesAndHrAction.crearListaActivitiesAndHr()}"
							onclick="#{rich:component('popUpEditarActivitiesAndHr')}.hide(); #{rich:component('popupTrabajador')}.hide(); #{rich:component('statPane')}.show();" />
					</div>
				</a:outputPanel>
			</rich:panel>
		</rich:popupPanel>
	</h:form>
	<h:form id="formAgregarTrabajador">
		<rich:popupPanel id="popUpAgregarTrabajador" modal="true"
			autosized="true" maxWidth="460" domElementAttachment="form"
			minWidth="250"
			header="#{activitiesAndHrAction.trabajador.name} #{activitiesAndHrAction.trabajador.familyName}">
			<f:facet name="controls">
				<h:panelGroup>
					<h:graphicImage value="/img/close_14.png"
						onmouseover="this.src='#{request.contextPath}/img/closeHover_14.png';"
						onmouseout="this.src='#{request.contextPath}/img/close_14.png';"
						styleClass="hidelink cursor"
						onclick="#{rich:component('popUpAgregarTrabajador')}.hide()" />
				</h:panelGroup>
			</f:facet>
			<rich:panel styleClass="H172P fondoAnchoUno">
				<a:outputPanel id="outputAgregarTrabajador">
					<div align="center">
						<h:panelGrid columns="3" columnClasses="right, left, left">
							<h:outputText value="#{mensaje.label_hora_inicio}" />
							<h:inputText disabled="true" styleClass="W91P"
								value="#{activitiesAndHrAction.actividadSeleccionada.initialDtBudget}">
								<f:convertDateTime type="date" pattern="HH:mm" locale="en" />
							</h:inputText>
							<h:outputText value="" />
							<h:outputText value="#{mensaje.label_hora_fin}" />
							<h:inputText disabled="true" styleClass="W91P"
								value="#{activitiesAndHrAction.actividadSeleccionada.finalDtBudget}">
								<f:convertDateTime type="date" pattern="HH:mm" locale="en" />
							</h:inputText>
							<h:outputText value="" />
							<h:outputText
								value="#{mensajeCosts.cycle_standard_activities_label_duracion}" />
							<h:inputText id="duracionBudget" styleClass="W91P"
								validator="#{activitiesAndHrAction.validar}" required="true"
								converterMessage="#{mensaje.message_juego_caracter_numeros}"
								requiredMessage="#{mensaje.message_campo_requerido}"
								value="#{activitiesAndHrAction.activitiesAndHr.durationBudget}" />
							<rich:message for="duracionBudget" />
						</h:panelGrid>
					</div>
					<br />
					<div align="center">
						<a:commandButton value="#{mensaje.button_aceptar}"
							render="formGenerico, seleccionarTrabajador:trabajadores "
							actionListener="#{activitiesAndHrAction.agregarTrabajadores()}"
							oncomplete="if (#{facesContext.maximumSeverity==null}) {#{rich:component('popUpAgregarTrabajador')}.hide();}
									else { setFocus(#{rich:element('formGenerico:valFocus')}.value); }">
						</a:commandButton>
						<a:commandButton value="#{mensaje.button_cancelar}"
							render="seleccionarTrabajador:trabajadores"
							onclick="#{rich:component('popUpAgregarTrabajador')}.hide()" />
					</div>
				</a:outputPanel>
			</rich:panel>
		</rich:popupPanel>
	</h:form>
	<h:form id="formConfirmarSeleccionTrabajador">
		<rich:popupPanel id="popUpConfirmarSeleccionTrabajador" modal="true"
			autosized="true" maxWidth="800"
			header="#{mensaje.label_confirmacion}">
			<f:facet name="controls">
				<h:panelGroup>
					<h:graphicImage value="/img/close_14.png"
						onmouseover="this.src='#{request.contextPath}/img/closeHover_14.png';"
						onmouseout="this.src='#{request.contextPath}/img/close_14.png';"
						styleClass="hidelink cursor"
						onclick="#{rich:component('popUpConfirmarSeleccionTrabajador')}.hide()" />
				</h:panelGroup>
			</f:facet>
			<ui:decorate template="/plantillas/mensajeConfirmar.xhtml">
				<ui:define name="mensaje">
					<h:outputText value="#{mensaje.message_registro_confirmacion}"
						styleClass="etiquetaTitulo" />
				</ui:define>
				<ui:define name="botones">
					<a:commandButton value="#{mensaje.button_aceptar}"
						render=":formActivitiesAndHr, mensajes, mensajeBusqueda"
						actionListener="#{activitiesAndHrAction.crearListaActivitiesAndHr()}"
						onclick="#{rich:component('popUpConfirmarSeleccionTrabajador')}.hide(); #{rich:component('popUpEditarActivitiesAndHr')}.hide(); #{rich:component('popupTrabajador')}.hide(); #{rich:component('statPane')}.show();" />
					<a:commandButton value="#{mensaje.button_cancelar}"
						onclick="#{rich:component('popUpConfirmarSeleccionTrabajador')}.hide()" />
				</ui:define>
			</ui:decorate>
		</rich:popupPanel>
	</h:form>
	<h:form id="formEditarActivitiesAndHr">
		<rich:popupPanel id="popUpEditarActivitiesAndHr" modal="true"
			domElementAttachment="form" autosized="true" width="1200"
			maxWidth="1300"
			header="#{mensajeMenu.recursos_humanos_activities_label}">
			<f:facet name="controls">
				<h:panelGroup>
					<h:graphicImage value="/img/close_14.png"
						onmouseover="this.src='#{request.contextPath}/img/closeHover_14.png';"
						onmouseout="this.src='#{request.contextPath}/img/close_14.png';"
						styleClass="hidelink cursor"
						onclick="#{rich:component('popUpEditarActivitiesAndHr')}.hide()" />
				</h:panelGroup>
			</f:facet>
			<t:fieldset styleClass="BorderW2P">
				<legend class="etiquetaTitulo">#{activitiesAndHrAction.activitiesAndHr.activitiesAndHrPK.hr.name}
					#{activitiesAndHrAction.activitiesAndHr.activitiesAndHrPK.hr.familyName}</legend>
				<a:outputPanel id="outPutAgregarActivitiesAndHr">
					<a:outputPanel>
						<h:panelGrid columns="1" columnClasses="center">
							<rich:message for="duracionBudgetEditar" />
						</h:panelGrid>
						<br />
						<h:panelGrid columns="3" columnClasses=" center, center, center">
							<h:outputText value="#{mensaje.label_fecha_inicio}"
								styleClass="etiquetaTitulo" />
							<h:outputText value="#{mensaje.label_fecha_fin}"
								styleClass="etiquetaTitulo" />
							<h:outputText
								value="#{mensajeCosts.cycle_standard_activities_label_duracion}"
								styleClass="etiquetaTitulo" />
							<p:calendar
								value="#{activitiesAndHrAction.activitiesAndHr.initialDateTimeBudget}"
								readonlyInput="true" pattern="MM/dd/yyyy HH:mm"
								styleClass="W104P" id="fechaInicio_" showOn="button"
								maxdate="#{activitiesAndHrAction.activitiesAndHr.finalDateTimeBudget}"
								mindate="#{activitiesAndHrAction.actividadSeleccionada.initialDtBudget}"
								navigator="true"
								converterMessage="#{mensaje.message_validar_formato_fecha}">
								<p:ajax event="dateSelect"
									update="fechaFinal_, formEditarActivitiesAndHr:outPutAgregarActivitiesAndHr"
									listener="#{activitiesAndHrAction.calculateDuration()}" />
							</p:calendar>
							<p:calendar
								value="#{activitiesAndHrAction.activitiesAndHr.finalDateTimeBudget}"
								readonlyInput="true" pattern="MM/dd/yyyy HH:mm"
								styleClass="W104P" id="fechaFinal_" showOn="button"
								maxdate="#{activitiesAndHrAction.actividadSeleccionada.finalDtBudget}"
								mindate="#{activitiesAndHrAction.activitiesAndHr.initialDateTimeBudget}"
								navigator="true"
								converterMessage="#{mensaje.message_validar_formato_fecha}">
								<p:ajax event="dateSelect"
									update="fechaInicio_, formEditarActivitiesAndHr:outPutAgregarActivitiesAndHr"
									listener="#{activitiesAndHrAction.calculateDuration()}" />
							</p:calendar>
							<h:inputText id="duracionBudgetEditar" required="true"
								requiredMessage="#{mensaje.message_duration_requerido}"
								converterMessage="#{mensaje.message_duration_caracter_numeros}"
								validator="#{activitiesAndHrAction.validar}"
								value="#{activitiesAndHrAction.activitiesAndHr.durationBudget}"
								styleClass="W125P">
								<f:attribute name="var" value="si" />
								<f:ajax event="blur"
									listener="#{activitiesAndHrAction.validarWorkLoad(activitiesAndHrAction.activitiesAndHr.durationBudget, activitiesAndHrAction.activitiesAndHr.activitiesAndHrPK.hr.idHr)}"
									render="formEditarActivitiesAndHr:outPutAgregarActivitiesAndHr" />
							</h:inputText>
						</h:panelGrid>

						<h:panelGrid columns="4"
							columnClasses=" center, center, center, center">

							<h:outputText
								value="#{mensajeCosts.activities_and_hr_label_hora_normal}"
								styleClass="etiquetaTitulo" />
							<h:outputText
								value="#{mensajeCosts.activities_and_hr_label_horas_extra}"
								styleClass="etiquetaTitulo" />
							<h:outputText value="#{mensaje.label_total}"
								styleClass="etiquetaTitulo" />
							<h:outputText
								value="#{mensajeRecursosHumanos.overtime_payment_rate_label}"
								styleClass="etiquetaTitulo" />
							<h:inputText disabled="true" id="normalHours"
								value="#{activitiesAndHrAction.activitiesAndHr.normalHours}"
								styleClass="W82P" />
							<h:inputText disabled="true"
								value="#{activitiesAndHrAction.activitiesAndHr.overtimeHours}"
								styleClass="W82P" />
							<h:inputText disabled="true"
								value="#{activitiesAndHrAction.activitiesAndHr.totalHours}"
								styleClass="W82P" />
							<h:selectOneMenu value="#{activitiesAndHrAction.idOvertimeRate}">
								<f:selectItems
									value="#{activitiesAndHrAction.listOvertimePaymentRate}" />
							</h:selectOneMenu>
						</h:panelGrid>
						<br />
						<br />
						<div align="center">
							<a:commandButton value="#{mensaje.button_guardar}"
								execute="formEditarActivitiesAndHr"
								render="formConfirmarSeleccionTrabajador:popUpConfirmarSeleccionTrabajador,formGenerico"
								oncomplete="if (#{facesContext.maximumSeverity==null})
								{#{rich:component('popUpConfirmarSeleccionTrabajador')}.show();} else{ 
								setFocus(#{rich:element('formGenerico:valFocus')}.value); }" />
							<a:commandButton value="#{mensaje.button_cancelar}"
								onclick="#{rich:component('popUpEditarActivitiesAndHr')}.hide()" />
						</div>
						<br />
					</a:outputPanel>
				</a:outputPanel>
			</t:fieldset>
		</rich:popupPanel>
	</h:form>
	<h:form>
		<rich:popupPanel id="popupEliminar" autosized="true" modal="true"
			header="#{mensaje.label_confirmacion}">
			<f:facet name="controls">
				<h:panelGroup>
					<h:graphicImage value="/img/close_14.png"
						onmouseover="this.src='#{request.contextPath}/img/closeHover_14.png';"
						onmouseout="this.src='#{request.contextPath}/img/close_14.png';"
						onclick="#{rich:component('popupEliminar')}.hide()"
						styleClass="cursor" />
				</h:panelGroup>
			</f:facet>
			<ui:decorate template="/plantillas/mensajeConfirmar.xhtml">
				<ui:define name="mensaje">
					<h:outputText value="#{mensaje.message_eliminar_confirmacion}"
						styleClass="etiquetaTitulo" />
				</ui:define>
				<ui:define name="campos">
					<h:outputText value="#{mensaje.label_nombre}:" />
					<h:outputText
						value="#{activitiesAndHrAction.activitiesAndHr.activitiesAndHrPK.hr.name}" />
				</ui:define>
				<ui:define name="botones">
					<a:commandButton value="#{mensaje.button_aceptar}"
						render="formActivitiesAndHr, mensajes, mensajeBusqueda"
						actionListener="#{activitiesAndHrAction.eliminarActivitiesAndHr()}"
						onclick="#{rich:component('popupEliminar')}.hide();" />
					<a:commandButton value="#{mensaje.button_cancelar}"
						onclick="#{rich:component('popupEliminar')}.hide()" />
				</ui:define>
			</ui:decorate>
		</rich:popupPanel>
	</h:form>
</ui:composition>